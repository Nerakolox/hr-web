import{r as S,u as b}from"./xlsx-DPk0xC4-.js";import{s as y}from"./axios-CVbaXV-p.js";import{_ as g,c as x,b as l,w as t,a as U,r as s,o as A,f}from"./index-BeX5Rnoo.js";const v={components:{},data(){return{tableData:[],tableData2:[]}},mounted(){},beforeUnmount(){},methods:{delRow(r){this.tableData.splice(r.$index,1)},addRows(){this.tableData.push({})},upLoadDatas(){this.$alert("请再次确认信息录入是否正确","上传确认",{confirmButtonText:"确定",dangerouslyUseHTMLString:!0,callback:r=>{if(r=="confirm"){const i=this.tableData;y.post("addsalary",i).then(m=>{console.log(m),this.$message({type:"success",message:"已上传",plain:!0}),this.tableData=[],this.tableData2=[]})}}})},beforeUpload(r){return this.readExcel(r),!1},readExcel(r){const i=new FileReader;i.onload=m=>{try{const c=new Uint8Array(m.target.result),u=S(c,{type:"array"}),_=u.SheetNames[0],p=u.Sheets[_];let V=b.sheet_to_json(p,{header:1});var w=V.slice(1);const o=new Date,d=o.getFullYear(),h=String(o.getMonth()+1).padStart(2,"0"),e=w.map(n=>({Username:n[0].toString(),Certificate:n[1].toString(),CreditCard:n[2].toString(),Telephone:n[3].toString(),BasicSalary:n[4].toString(),AttendanceRequired:n[5].toString(),AttendanceActual:n[6].toString(),WorkHour:n[7].toString(),Performance:n[8].toString(),Allowance:n[9].toString(),Subsidy:n[10].toString(),OvertimeSalary:n[11].toString(),Excitation:n[12].toString(),Discipline:n[13].toString(),Withholding:n[14].toString(),BackPayment:n[15].toString(),ShouldSalary:n[16].toString(),UtilitiesFee:n[17].toString(),Tax:n[18].toString(),AdvanceSalary:n[19].toString(),ActualSalary:n[20].toString(),Date:`${d}-${h}`}));this.tableData2=e;const a=`
                        <div>
                            <div>读取内容如下，是否加载到工作表中。<strong>此操作会覆盖工作表，请谨慎确定！</strong></div>
                            <div>表头：${V[0]}</div>
                            <div>第一行：${V[1]}</div>
                        </div>
                    `;this.$alert(`${a}`,"内容阅览",{confirmButtonText:"确定",dangerouslyUseHTMLString:!0,callback:n=>{n=="confirm"&&(this.$message({type:"success",message:"已加载",plain:!0}),this.tableData=e)}})}catch(c){ElMessage({message:`读取或处理Excel文件时出错：${c}`,type:"error",plain:!0})}},i.onerror=m=>{console.error("读取文件时发生错误",m)},i.readAsArrayBuffer(r)}}},D={class:"p-2"},k=U("h4",{class:"mb-4"},"工资录入",-1),C={class:"d-flex flex-row justify-content-end"};function B(r,i,m,w,c,u){const _=s("el-divider"),p=s("el-button"),V=s("el-upload"),o=s("el-input"),d=s("el-table-column"),h=s("el-table");return A(),x("div",D,[k,l(_,{"content-position":"left"},{default:t(()=>[f("工资录入 工资录入")]),_:1}),U("div",C,[l(V,{ref:"upload",class:"upload-demo",accept:".xlsx",action:"#",limit:1,"auto-upload":!0,"before-upload":u.beforeUpload},{trigger:t(()=>[l(p,{type:"primary",plain:""},{default:t(()=>[f("读取excel文件")]),_:1})]),_:1},8,["before-upload"]),l(p,{class:"ms-3",plain:"",onClick:u.addRows},{default:t(()=>[f("添加表格行")]),_:1},8,["onClick"]),l(p,{type:"success",plain:"",onClick:u.upLoadDatas},{default:t(()=>[f("上传薪资信息")]),_:1},8,["onClick"])]),l(h,{data:c.tableData,stripe:"",border:"",style:{"max-width":"100%",width:"100%"}},{default:t(()=>[l(d,{fixed:"",prop:"Username",label:"姓名",width:"140"},{default:t(e=>[l(o,{modelValue:e.row.Username,"onUpdate:modelValue":a=>e.row.Username=a},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),l(d,{prop:"Certificate",label:"身份证",width:"180"},{default:t(e=>[l(o,{modelValue:e.row.Certificate,"onUpdate:modelValue":a=>e.row.Certificate=a},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),l(d,{prop:"Telephone",label:"电话",width:"120"},{default:t(e=>[l(o,{modelValue:e.row.Telephone,"onUpdate:modelValue":a=>e.row.Telephone=a},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),l(d,{prop:"CreditCard",label:"银行卡号",width:"180"},{default:t(e=>[l(o,{modelValue:e.row.CreditCard,"onUpdate:modelValue":a=>e.row.CreditCard=a},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),l(d,{prop:"BasicSalary",label:"基本工资",width:"100"},{default:t(e=>[l(o,{modelValue:e.row.BasicSalary,"onUpdate:modelValue":a=>e.row.BasicSalary=a},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),l(d,{prop:"AttendanceRequired",label:"应出勤天数",width:"100"},{default:t(e=>[l(o,{modelValue:e.row.AttendanceRequired,"onUpdate:modelValue":a=>e.row.AttendanceRequired=a},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),l(d,{prop:"AttendanceActual",label:"实出勤天数",width:"100"},{default:t(e=>[l(o,{modelValue:e.row.AttendanceActual,"onUpdate:modelValue":a=>e.row.AttendanceActual=a},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),l(d,{prop:"WorkHour",label:"总工时"},{default:t(e=>[l(o,{modelValue:e.row.WorkHour,"onUpdate:modelValue":a=>e.row.WorkHour=a},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),l(d,{prop:"Performance",label:"绩效"},{default:t(e=>[l(o,{modelValue:e.row.Performance,"onUpdate:modelValue":a=>e.row.Performance=a},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),l(d,{prop:"Allowance",label:"津贴"},{default:t(e=>[l(o,{modelValue:e.row.Allowance,"onUpdate:modelValue":a=>e.row.Allowance=a},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),l(d,{prop:"Subsidy",label:"补助"},{default:t(e=>[l(o,{modelValue:e.row.Subsidy,"onUpdate:modelValue":a=>e.row.Subsidy=a},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),l(d,{prop:"OvertimeSalary",label:"加班工资",width:"100"},{default:t(e=>[l(o,{modelValue:e.row.OvertimeSalary,"onUpdate:modelValue":a=>e.row.OvertimeSalary=a},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),l(d,{prop:"Excitation",label:"正负激励",width:"100"},{default:t(e=>[l(o,{modelValue:e.row.Excitation,"onUpdate:modelValue":a=>e.row.Excitation=a},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),l(d,{prop:"Discipline",label:"违纪扣款",width:"100"},{default:t(e=>[l(o,{modelValue:e.row.Discipline,"onUpdate:modelValue":a=>e.row.Discipline=a},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),l(d,{prop:"Withholding",label:"代扣部分",width:"100"},{default:t(e=>[l(o,{modelValue:e.row.Withholding,"onUpdate:modelValue":a=>e.row.Withholding=a},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),l(d,{prop:"BackPayment",label:"补发扣"},{default:t(e=>[l(o,{modelValue:e.row.BackPayment,"onUpdate:modelValue":a=>e.row.BackPayment=a},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),l(d,{prop:"ShouldSalary",label:"应发工资",width:"100"},{default:t(e=>[l(o,{modelValue:e.row.ShouldSalary,"onUpdate:modelValue":a=>e.row.ShouldSalary=a},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),l(d,{prop:"UtilitiesFee",label:"水电物业费",width:"100"},{default:t(e=>[l(o,{modelValue:e.row.UtilitiesFee,"onUpdate:modelValue":a=>e.row.UtilitiesFee=a},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),l(d,{prop:"Tax",label:"个税"},{default:t(e=>[l(o,{modelValue:e.row.Tax,"onUpdate:modelValue":a=>e.row.Tax=a},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),l(d,{prop:"AdvanceSalary",label:"预支工资",width:"100"},{default:t(e=>[l(o,{modelValue:e.row.AdvanceSalary,"onUpdate:modelValue":a=>e.row.AdvanceSalary=a},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),l(d,{prop:"ActualSalary",label:"实发工资",width:"100"},{default:t(e=>[l(o,{modelValue:e.row.ActualSalary,"onUpdate:modelValue":a=>e.row.ActualSalary=a},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),l(d,{prop:"Date",label:"日期",width:"120"},{default:t(e=>[l(o,{modelValue:e.row.Date,"onUpdate:modelValue":a=>e.row.Date=a},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),l(d,{fixed:"right",label:"操作"},{default:t(e=>[l(p,{type:"danger",size:"small",onClick:a=>u.delRow(e)},{default:t(()=>[f(" 删除 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])])}const W=g(v,[["render",B]]);export{W as default};
