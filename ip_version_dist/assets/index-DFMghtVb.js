import{_ as V,u as a,c as v,a as w,b as t,w as s,r as m,o as c,d as b,e as F,f as h,t as f,p as C,g as k}from"./index-D_kQPWUe.js";import{s as g,a as y}from"./axios-7hBZi-zt.js";const D={data(){return{codeText:"获取验证码",codeDisabled:!1,countDown:0,isRes:!1,ruleForm:{name:"",phone:"",idCard:"",code:""},rules:{name:[{required:!0,message:"请输入有效姓名",trigger:"blur"},{min:2,message:"请输入有效姓名",trigger:"blur"}],phone:[{required:!0,message:"请输入手机号",trigger:"blur"}],idCard:[{required:!0,message:"请输入身份证号码",trigger:"blur"},{pattern:/^[1-9]\d{5}(18|19|20)\d{2}((0[1-9])|(10|11|12))((0[1-9])|([1-2][0-9])|30|31)\d{3}[0-9Xx]$/,message:"请输入有效的身份证号码",trigger:"blur"}]}}},methods:{submitForm(l){this.$refs[l].validate(o=>{if(o)if(console.log("submit!"),this.isRes){const i={certificate:this.ruleForm.idCard,username:this.ruleForm.name,telephone:this.ruleForm.phone,authcode:this.ruleForm.code};g.post("/signup",i).then(n=>{this.isRes=!1})}else{const i={telephone:this.ruleForm.phone,authcode:this.ruleForm.code};g.post("/login",i).then(n=>{y.set("token",n.data.token),a().writeUsername(n.data.username),a().writeTelephone(n.data.telephone),a().writeAdmin(n.data.admin),a().admin?this.$router.push({path:"/admin"}):this.$router.push({path:"/user"})}).catch(n=>{})}else return console.log("error submit!!"),!1})},getAuthCode(){var l=/^1[3-9]\d{9}$/;if(l.test(this.ruleForm.phone)){g.get(`/sms?telephone=${this.ruleForm.phone}`).then(i=>{}),this.codeDisabled=!0,this.countDown=60,this.codeText=`请${this.countDown}秒后再试`;let o=setInterval(()=>{this.countDown--,this.codeText=`请${this.countDown}秒后再试`,this.countDown<=0&&(this.codeText="获取验证码",clearInterval(o),this.codeDisabled=!1)},1e3)}else this.$message({message:"请检查手机号是否正确",type:"error",duration:5e3,plain:!0})}}},R=l=>(C("data-v-4edc8dea"),l=l(),k(),l),T={class:"w-100 d-flex justify-content-center align-items-center",style:{height:"100vh"}},I={class:"log-res-box",style:{"box-shadow":"var(--el-box-shadow-dark)"}},q=R(()=>w("h4",{class:"text-center mt-3"},"实习生小助手",-1));function S(l,o,i,n,e,_){const d=m("el-input"),u=m("el-form-item"),p=m("el-button"),x=m("el-form");return c(),v("div",T,[w("div",I,[q,t(x,{model:e.ruleForm,rules:e.rules,ref:"ruleForm","label-position":"top",style:{width:"100%"}},{default:s(()=>[e.isRes?(c(),b(u,{key:0,label:"姓名",prop:"name"},{default:s(()=>[t(d,{modelValue:e.ruleForm.name,"onUpdate:modelValue":o[0]||(o[0]=r=>e.ruleForm.name=r)},null,8,["modelValue"])]),_:1})):F("",!0),e.isRes?(c(),b(u,{key:1,label:"身份证",prop:"idCard"},{default:s(()=>[t(d,{modelValue:e.ruleForm.idCard,"onUpdate:modelValue":o[1]||(o[1]=r=>e.ruleForm.idCard=r)},null,8,["modelValue"])]),_:1})):F("",!0),t(u,{label:"手机号",prop:"phone"},{default:s(()=>[t(d,{modelValue:e.ruleForm.phone,"onUpdate:modelValue":o[2]||(o[2]=r=>e.ruleForm.phone=r)},null,8,["modelValue"])]),_:1}),t(u,{label:"验证码",prop:"code"},{default:s(()=>[t(d,{modelValue:e.ruleForm.code,"onUpdate:modelValue":o[3]||(o[3]=r=>e.ruleForm.code=r)},{append:s(()=>[t(p,{onClick:_.getAuthCode,disabled:e.codeDisabled},{default:s(()=>[h(f(e.codeText),1)]),_:1},8,["onClick","disabled"])]),_:1},8,["modelValue"])]),_:1}),t(u,null,{default:s(()=>[t(p,{type:"primary",onClick:o[4]||(o[4]=r=>_.submitForm("ruleForm")),class:"w-100"},{default:s(()=>[h("立即"+f(e.isRes?"注册":"登录"),1)]),_:1}),t(p,{class:"w-100 mt-1 ms-0",onClick:o[5]||(o[5]=r=>e.isRes=!e.isRes)},{default:s(()=>[h("前往"+f(e.isRes?"登录":"注册"),1)]),_:1})]),_:1})]),_:1},8,["model","rules"])])])}const N=V(D,[["render",S],["__scopeId","data-v-4edc8dea"]]);export{N as default};
