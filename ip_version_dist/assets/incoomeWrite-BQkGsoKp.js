import{r as y,u as U}from"./xlsx-DPk0xC4-.js";import{_ as S,s as g,c as x,d as l,w as t,b,r as c,o as A,g as h}from"./index-D49ookEs.js";const k={components:{},data(){return{tableData:[],tableData2:[]}},mounted(){},beforeUnmount(){},methods:{delRow(u){this.tableData.splice(u.$index,1)},addRows(){this.tableData.push({})},upLoadDatas(){this.$alert("请再次确认信息录入是否正确","上传确认",{confirmButtonText:"确定",dangerouslyUseHTMLString:!0,callback:u=>{if(u=="confirm"){const s=this.tableData,f=(n=>JSON.parse(JSON.stringify(n,(i,m)=>typeof m=="number"||typeof m=="boolean"?m.toString():m)))(s);console.log(f),g.post("addsalary",f).then(n=>{console.log(n),this.$message({type:"success",message:"已上传",plain:!0}),this.tableData=[],this.tableData2=[]})}}})},beforeUpload(u){return this.readExcel(u),!1},readExcel(u){const s=new FileReader;s.onload=V=>{try{const n=new Uint8Array(V.target.result),i=y(n,{type:"array"}),m=i.SheetNames[0],p=i.Sheets[m];let w=U.sheet_to_json(p,{header:1});var f=w.slice(1);const o=new Date,d=o.getFullYear(),_=String(o.getMonth()+1).padStart(2,"0"),e=f.map(r=>({Username:r[0],Certificate:r[1],CreditCard:r[2],Telephone:r[3],BasicSalary:r[4],AttendanceRequired:r[5],AttendanceActual:r[6],WorkHour:r[7],Performance:r[8],Allowance:r[9],Subsidy:r[10],OvertimeSalary:r[11],Excitation:r[12],Discipline:r[13],Withholding:r[14],BackPayment:r[15],ShouldSalary:r[16],UtilitiesFee:r[17],Tax:r[18],AdvanceSalary:r[19],ActualSalary:r[20],Date:`${d}-${_}`}));this.tableData2=e;const a=`
                        <div style="word-wrap: break-word;max-width:400px;">
                            <p style="word-wrap: break-word;">读取内容如下，是否加载到工作表中。<strong>此操作会覆盖工作表，请谨慎确定！</strong></p>
                            <p style="word-wrap: break-word;">表头：${w[0]}</p>
                            <p style="word-wrap: break-word;">第一行：${w[1]}</p>
                        </div>
                    `;this.$alert(`${a}`,"内容阅览",{confirmButtonText:"确定",dangerouslyUseHTMLString:!0,callback:r=>{r=="confirm"&&(this.$message({type:"success",message:"已加载",plain:!0}),this.tableData=e)}})}catch(n){this.$message({message:`读取或处理Excel文件时出错：${n}`,type:"error",plain:!0})}},s.onerror=V=>{console.error("读取文件时发生错误",V)},s.readAsArrayBuffer(u)}}},D={class:"p-2"},C=b("h4",{class:"mb-4"},"工资录入",-1),v={class:"d-flex flex-row justify-content-end"};function B(u,s,V,f,n,i){const m=c("el-divider"),p=c("el-button"),w=c("el-upload"),o=c("el-input"),d=c("el-table-column"),_=c("el-table");return A(),x("div",D,[C,l(m,{"content-position":"left"},{default:t(()=>[h("工资录入 工资录入")]),_:1}),b("div",v,[l(w,{ref:"upload",class:"upload-demo",accept:".xlsx",action:"#",limit:1,"auto-upload":!0,"before-upload":i.beforeUpload},{trigger:t(()=>[l(p,{type:"primary",plain:""},{default:t(()=>[h("读取excel文件")]),_:1})]),_:1},8,["before-upload"]),l(p,{class:"ms-3",plain:"",onClick:i.addRows},{default:t(()=>[h("添加表格行")]),_:1},8,["onClick"]),l(p,{type:"success",plain:"",onClick:i.upLoadDatas},{default:t(()=>[h("上传薪资信息")]),_:1},8,["onClick"])]),l(_,{data:n.tableData,stripe:"",border:"",style:{"max-width":"100%",width:"100%"}},{default:t(()=>[l(d,{fixed:"",prop:"Username",label:"姓名",width:"140"},{default:t(e=>[l(o,{modelValue:e.row.Username,"onUpdate:modelValue":a=>e.row.Username=a},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),l(d,{prop:"Certificate",label:"身份证",width:"180"},{default:t(e=>[l(o,{modelValue:e.row.Certificate,"onUpdate:modelValue":a=>e.row.Certificate=a},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),l(d,{prop:"Telephone",label:"电话",width:"120"},{default:t(e=>[l(o,{modelValue:e.row.Telephone,"onUpdate:modelValue":a=>e.row.Telephone=a},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),l(d,{prop:"CreditCard",label:"银行卡号",width:"180"},{default:t(e=>[l(o,{modelValue:e.row.CreditCard,"onUpdate:modelValue":a=>e.row.CreditCard=a},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),l(d,{prop:"BasicSalary",label:"基本工资",width:"100"},{default:t(e=>[l(o,{modelValue:e.row.BasicSalary,"onUpdate:modelValue":a=>e.row.BasicSalary=a},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),l(d,{prop:"AttendanceRequired",label:"应出勤天数",width:"100"},{default:t(e=>[l(o,{modelValue:e.row.AttendanceRequired,"onUpdate:modelValue":a=>e.row.AttendanceRequired=a},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),l(d,{prop:"AttendanceActual",label:"实出勤天数",width:"100"},{default:t(e=>[l(o,{modelValue:e.row.AttendanceActual,"onUpdate:modelValue":a=>e.row.AttendanceActual=a},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),l(d,{prop:"WorkHour",label:"总工时"},{default:t(e=>[l(o,{modelValue:e.row.WorkHour,"onUpdate:modelValue":a=>e.row.WorkHour=a},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),l(d,{prop:"Performance",label:"绩效"},{default:t(e=>[l(o,{modelValue:e.row.Performance,"onUpdate:modelValue":a=>e.row.Performance=a},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),l(d,{prop:"Allowance",label:"津贴"},{default:t(e=>[l(o,{modelValue:e.row.Allowance,"onUpdate:modelValue":a=>e.row.Allowance=a},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),l(d,{prop:"Subsidy",label:"补助"},{default:t(e=>[l(o,{modelValue:e.row.Subsidy,"onUpdate:modelValue":a=>e.row.Subsidy=a},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),l(d,{prop:"OvertimeSalary",label:"加班工资",width:"100"},{default:t(e=>[l(o,{modelValue:e.row.OvertimeSalary,"onUpdate:modelValue":a=>e.row.OvertimeSalary=a},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),l(d,{prop:"Excitation",label:"正负激励",width:"100"},{default:t(e=>[l(o,{modelValue:e.row.Excitation,"onUpdate:modelValue":a=>e.row.Excitation=a},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),l(d,{prop:"Discipline",label:"违纪扣款",width:"100"},{default:t(e=>[l(o,{modelValue:e.row.Discipline,"onUpdate:modelValue":a=>e.row.Discipline=a},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),l(d,{prop:"Withholding",label:"代扣部分",width:"100"},{default:t(e=>[l(o,{modelValue:e.row.Withholding,"onUpdate:modelValue":a=>e.row.Withholding=a},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),l(d,{prop:"BackPayment",label:"补发扣"},{default:t(e=>[l(o,{modelValue:e.row.BackPayment,"onUpdate:modelValue":a=>e.row.BackPayment=a},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),l(d,{prop:"ShouldSalary",label:"应发工资",width:"100"},{default:t(e=>[l(o,{modelValue:e.row.ShouldSalary,"onUpdate:modelValue":a=>e.row.ShouldSalary=a},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),l(d,{prop:"UtilitiesFee",label:"水电物业费",width:"100"},{default:t(e=>[l(o,{modelValue:e.row.UtilitiesFee,"onUpdate:modelValue":a=>e.row.UtilitiesFee=a},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),l(d,{prop:"Tax",label:"个税"},{default:t(e=>[l(o,{modelValue:e.row.Tax,"onUpdate:modelValue":a=>e.row.Tax=a},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),l(d,{prop:"AdvanceSalary",label:"预支工资",width:"100"},{default:t(e=>[l(o,{modelValue:e.row.AdvanceSalary,"onUpdate:modelValue":a=>e.row.AdvanceSalary=a},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),l(d,{prop:"ActualSalary",label:"实发工资",width:"100"},{default:t(e=>[l(o,{modelValue:e.row.ActualSalary,"onUpdate:modelValue":a=>e.row.ActualSalary=a},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),l(d,{prop:"Date",label:"日期",width:"120"},{default:t(e=>[l(o,{modelValue:e.row.Date,"onUpdate:modelValue":a=>e.row.Date=a},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),l(d,{fixed:"right",label:"操作"},{default:t(e=>[l(p,{type:"danger",size:"small",onClick:a=>i.delRow(e)},{default:t(()=>[h(" 删除 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])])}const R=S(k,[["render",B]]);export{R as default};
